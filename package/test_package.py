import os
import rcecML
# %% ------------------------------------------------------------------------
# %% ------------------------------------------------------------------------
os.chdir('/NFS15/michaelliao/retrievaldata')
# %% ------------------------------------------------------------------------
random_seed = 7036
n_components = 5
# %% ------------------------------------------------------------------------
ML = rcecML.MIMORegressionMachineLearner()
# %% ------------------------------------------------------------------------
ML.randomStateSetter(random_seed)
# %% ------------------------------------------------------------------------
ML.dataLoader(var_x='./train_x.csv',
              var_y='./train_y_Temp.csv',
              test_size=0.2)
# %% ------------------------------------------------------------------------
ML.standardizeX()
# %% ------------------------------------------------------------------------
ML.pcaY(n_components)
# %% ------------------------------------------------------------------------
ML.neuralNetworkInitialize()
ML.neuralNetworkCriterionSetter()
ML.neuralNetworkOptimizerSetter()
# %% ------------------------------------------------------------------------
ML.neuralNetworkModifyActivation(1)
# %% ------------------------------------------------------------------------
ML.trainNN(7000)
# %% ------------------------------------------------------------------------
ML.predictNN()
# %% ------------------------------------------------------------------------
ML.plotLossNN()
ML.plotMSENN()


# %% ------------------------------------------------------------------------
ML.randomForestRegressorInitialize()
# %% ------------------------------------------------------------------------
# ML.hyperparamSetter('min_samples_split', 2)
# %% ------------------------------------------------------------------------
ML.trainRFXGB()
# %% ------------------------------------------------------------------------
ML.predictRFXGB()
